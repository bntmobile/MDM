 --  Campos CODIGO de BARRAS
			Select
			  RR.RMRESC
			--, RRA.CODIGODEBARRAS1	[CODIGODEBARRAS1]
			--, PPCB.[EAN 13]			[Codigo de Barras-EAN 13 CDB]
			--, PPE.[EAN 13]			[Codigo de Barras-EAN 13 EXTEN]
			--, RRA.CODIGODEBARRAS2   [CODIGODEBARRAS2]
			--, PPCB.[DUN14]			[Codigo de Barras-DUN 14 CDB]
			--, PPE.[DUN14]			[Codigo de Barras-DUN 14 EXTEN]
			--, RRA.CODIGODEBARRAS8   [CODIGODEBARRAS8]
			--, PPCB.[DUN14T]			[Codigo de Barras-DUN 14T CDB]
			--, PPE.[DUN14T]			[Codigo de Barras-DUN 14T EXTEN]
			, RIGHT('000000000000000'+ISNULL( LTRIM(RTRIM(RRA.CODIGODEBARRAS1)),'0'),15)	[CODIGODEBARRAS1]
			, RIGHT('000000000000000'+ISNULL( LTRIM(RTRIM(PPCB.[EAN 13]		 )),'0'),15)	[Codigo de Barras-EAN 13 CDB]
			, RIGHT('000000000000000'+ISNULL( LTRIM(RTRIM(PPE.[EAN 13]		 )),'0'),15)	[Codigo de Barras-EAN 13 EXTEN]
			, RIGHT('000000000000000'+ISNULL( LTRIM(RTRIM(RRA.CODIGODEBARRAS2)),'0'),15)   [CODIGODEBARRAS2]
			, RIGHT('000000000000000'+ISNULL( LTRIM(RTRIM(PPCB.[DUN14]		 )),'0'),15)	[Codigo de Barras-DUN 14 CDB]
			, RIGHT('000000000000000'+ISNULL( LTRIM(RTRIM(PPE.[DUN14]		 )),'0'),15)	[Codigo de Barras-DUN 14 EXTEN]
			, RIGHT('000000000000000'+ISNULL( LTRIM(RTRIM(RRA.CODIGODEBARRAS8)),'0'),15)   [CODIGODEBARRAS8]
			, RIGHT('000000000000000'+ISNULL( LTRIM(RTRIM(PPCB.[DUN14T]		 )),'0'),15)	[Codigo de Barras-DUN 14T CDB]
			, RIGHT('000000000000000'+ISNULL( LTRIM(RTRIM(PPE.[DUN14T]		 )),'0'),15)	[Codigo de Barras-DUN 14T EXTEN]
			, Case When RIGHT('000000000000000'+ISNULL(LTRIM(RTRIM(RRA.CODIGODEBARRAS1)) ,'0'),15) = RIGHT('000000000000000'+ISNULL(LTRIM(RTRIM(PPCB.[EAN 13])) ,'0'),15) AND RIGHT('000000000000000'+ISNULL( LTRIM(RTRIM(PPCB.[EAN 13])) ,'0'),15)=RIGHT('000000000000000'+ISNULL(LTRIM(RTRIM(PPE.[EAN 13])) ,'0'),15) Then 'OK' Else 'NO OK' End [Ok:EAN13 CB_RMSA]
			, Case When RIGHT('000000000000000'+ISNULL(LTRIM(RTRIM(RRA.CODIGODEBARRAS2)) ,'0'),15) = RIGHT('000000000000000'+ISNULL(LTRIM(RTRIM(PPCB.[DUN14] )),'0'),15) AND RIGHT('000000000000000'+ISNULL(  LTRIM(RTRIM(PPCB.[DUN14])),'0'),15)=RIGHT('000000000000000'+ISNULL(  LTRIM(RTRIM(PPE.[DUN14])) ,'0'),15) Then 'OK' Else 'NO OK' End [Ok:-DUN 14  CB_RMSA]
			, Case When RIGHT('000000000000000'+ISNULL(LTRIM(RTRIM(RRA.CODIGODEBARRAS8)) ,'0'),15) = RIGHT('000000000000000'+ISNULL(LTRIM(RTRIM(PPCB.[DUN14T] )) ,'0'),15) AND RIGHT('000000000000000'+ISNULL(LTRIM(RTRIM(PPCB.[DUN14T])) ,'0'),15)=RIGHT('000000000000000'+ISNULL(LTRIM(RTRIM(PPE.[DUN14T])) ,'0'),15) Then 'OK' Else 'NO OK' End [Ok:DUN 14T  CB_RMSA]
			,PP.[Status_Name]
			into #tmpCDB
			From OPENQUERY(HDZ54,'SELECT * FROM HDZALM.RESMST') RR
			Left Join (SELECT * From OPENQUERY(HDZ54,'SELECT * FROM HDZALM.RESMSA')) RRA On RRA.NOPRODUCTO = RR.RMRESC --And RRA.ProcessDate = RR.ProcessDate
			left Join [HSVDMDDBPPSQL].MDMHERDEZ.mdm.vwMDM_ModeloProductos PP On PP.[Número de Recurso] = RR.RMRESC
			Left Join [HSVDMDDBPPSQL].MDMHERDEZ.mdm.vwMDM_ProductosExtendido PPE On PPE.[Codigo de Producto_ID] = PP.ID
			Left Join [HSVDMDDBPPSQL].MDMHERDEZ.mdm.vwMDM_Productos_Codigo_de_Barras PPCB On PPCB.[Codigo de Producto_ID] = PP.ID
	WHERE 1=1
	AND PP.Clase_Name='PT PRODUCTO TERMINADO' 
	AND RR.RMRSCL='PT'
	--AND RR.RMRESC IN('505023')


	SELECT RMRESC AS IdRecurso,A.[Codigo de Barras-EAN 13 EXTEN]
	FROM #tmpCDB A
	INNER JOIN (	SELECT    [Codigo de Barras-EAN 13 EXTEN], COUNT(1)CUENTA
					FROM #tmpCDB
					where [Codigo de Barras-EAN 13 EXTEN]<>'000000000000000'
					GROUP BY  [Codigo de Barras-EAN 13 EXTEN]
					HAVING COUNT(1)>1
					order by 2
				) B ON A.[Codigo de Barras-EAN 13 EXTEN]=B.[Codigo de Barras-EAN 13 EXTEN]
	order by 2,1



	SELECT RMRESC AS IdRecurso,A.[Codigo de Barras-DUN 14 EXTEN]
	FROM #tmpCDB A
	INNER JOIN (	SELECT    [Codigo de Barras-DUN 14 EXTEN], COUNT(1)CUENTA
					FROM #tmpCDB
					where [Codigo de Barras-DUN 14 EXTEN]<>'000000000000000'
					GROUP BY  [Codigo de Barras-DUN 14 EXTEN]
					HAVING COUNT(1)>1
					order by 2
					
				) B ON A.[Codigo de Barras-DUN 14 EXTEN]=B.[Codigo de Barras-DUN 14 EXTEN]
	order by 2,1



	
	SELECT RMRESC AS IdRecurso,A.[Codigo de Barras-DUN 14T EXTEN]
	FROM #tmpCDB A
	INNER JOIN (	SELECT    [Codigo de Barras-DUN 14T EXTEN], COUNT(1)CUENTA
					FROM #tmpCDB
					where [Codigo de Barras-DUN 14T EXTEN]<>'000000000000000'
					GROUP BY  [Codigo de Barras-DUN 14T EXTEN]
					HAVING COUNT(1)>1
					order by 2
					
				) B ON A.[Codigo de Barras-DUN 14T EXTEN]=B.[Codigo de Barras-DUN 14T EXTEN]
	order by 2,1

	